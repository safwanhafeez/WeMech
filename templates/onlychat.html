<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WeMech Community</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background-image: url("../static/image/community.jpg");
    background-size: cover;
  }
  .background-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("../static/image/community.jpg"); /* Background image */
    background-size: cover;
    filter: blur(4px); /* Apply blur effect */
    z-index: -1; /* Move the background behind other content */
  }

  .chat-container {
    position: relative; /* Make the chat box container relative to the body */
    z-index: 1; /* Ensure the chat box appears above the blurred background */
    width: 1000px; /* Make the container wider */
    background-color: rgba(45, 43, 43, 0.575); /* Set opacity and background color */
    border-radius: 10px; /* Add some rounded corners */
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); /* Add a subtle shadow */
    padding: 20px;
    margin: auto; /* Center the chat box horizontally */
  }

  .chat-card {
    width: 100%;
    background-color: #fff;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    overflow: hidden;
  }

  .chat-header {
    padding: 10px;
    background-color: #f2f2f2;
    display: flex;
    align-items: center;
  }

  .chat-header .h2 {
    font-size: 16px;
    color: #333;
  }

  .chat-body {
    padding: 35px;
  }

  .message {
    margin-bottom: 10px;
    padding: 10px;
    border-radius: 5px;
    position: relative; 
  }

  .incoming {
    background-color: #e1e1e1;
    text-align: left; /* Align incoming messages to the left */
  }

  .outgoing {
    background-color: #f2f2f2;
    text-align: right; /* Align outgoing messages to the right */
  }

  .message p {
    font-size: 14px;
    color: #333;
    margin: 0;
  }

  .chat-footer {
    padding: 10px;
    background-color: #f2f2f2;
    display: flex;
    justify-content: flex-end; /* Adjust alignment to position button to the right */
  }

  .chat-footer input[type="text"] {
    flex-grow: 1;
    padding: 5px;
    border: none;
    border-radius: 3px;
  }

  .chat-footer button {
    padding: 5px 10px;
    border: none;
    background-color: #4285f4;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .chat-footer button:hover {
    background-color: #0f9d58;
  }

  @keyframes chatAnimation {
    0% {
      opacity: 0;
      transform: translateY(10px);
    }

    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .chat-card .message {
    animation: chatAnimation 0.3s ease-in-out;
    animation-fill-mode: both;
    animation-delay: 0.1s;
  }

  .chat-card .message:nth-child(even) {
    animation-delay: 0.2s;
  }

  .chat-card .message:nth-child(odd) {
    animation-delay: 0.3s;
  }

  .profile-pic {
    position: absolute;
    top: 5px;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: #ccc; /* Placeholder background color */
  }

  /* Style for outgoing messages */
  .outgoing .profile-pic {
    right: -35px; /* Adjusted value */
  }

  /* Style for incoming messages */
  .incoming .profile-pic {
    left: -35px; /* Adjusted value */
  }

  /* Styles for live updates container */
  /* Removed live-updates-container styles */

  #checkbox {
    display: none;
  }

  .switch {
    position: absolute;
    left: 50%; /* Adjust the left position */
    top: 10%; /* Adjust the top position */
    transform: translate(-50%, -50%); /* Center the switch */
    width: 90px;
    height: 90px;
    background-color: rgb(99, 99, 99);
    border-radius: 50%;
    z-index: 1;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 5px;
    font-size: 0.9em;
    font-weight: 700;
    color: rgb(37, 37, 37);
    border: 2px solid rgb(126, 126, 126);
    box-shadow: 0px 0px 3px rgb(2, 2, 2) inset;
  }

  .svg {
    position: relative;
    width: 30%;
    height: 30%;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .svg path {
    fill: rgb(37, 37, 37);
  }

  #checkbox:checked + .switch .svg {
    filter: drop-shadow(0px 0px 3px rgb(222, 151, 255));
  }

  #checkbox:checked + .switch .svg path {
    fill: rgb(255, 255, 255);
  }

  #checkbox:checked + .switch {
    box-shadow: 0px 0px 1px rgb(222, 151, 255) inset,
        0px 0px 2px rgb(222, 151, 255) inset,
        0px 0px 10px rgb(222, 151, 255) inset,
        0px 0px 40px rgb(222, 151, 255),
        0px 0px 100px rgb(222, 151, 255),
        0px 0px 5px rgb(222, 151, 255);
        border: 2px solid rgb(255, 255, 255);
        background-color: rgb(152, 107, 172);
        color: rgb(255, 255, 255);
      }
</style>
</head>
<body>
  <div class="background-container"></div>
  <div class="chat-container">
    <div class="chat-card">
      <div class="chat-header">
        <div class="h2">WeMech Community</div>
      </div>
      <div class="chat-body" id="chat-body">
        <div class="message incoming">
          <img src="../static/image/user-profile-icon-free-vector.jpg" alt="Profile Picture" class="profile-pic">
          <p>Just got my hands on the latest BMW M3, and it's a beast on the road!</p>
        </div>
        <div class="message incoming">
          <img src="../static/image/myprofile.jpg" alt="Profile Picture" class="profile-pic">
          <p>Thinking about adding some custom rims to my Dodge Charger, any thoughts?</p>
        </div>
        <div class="message incoming">
          <img src="../static/image/userlogo.png" alt="Profile Picture" class="profile-pic">
          <p>Can't wait to see the new electric pickup trucks hitting the market soon!</p>
        </div>
        <div class="message incoming">
          <img src="../static/image/round-account-button-with-user-inside.png" alt="Profile Picture" class="profile-pic">
          <p>Upgrading my suspension setup for better handling on the track.</p>
        </div>
      </div>
      <div class="chat-footer">
        <input placeholder="Type your message" type="text" id="user-input">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>
    
  </div>
  <input id="checkbox" type="checkbox">
  <label class="switch" for="checkbox">
    <svg viewBox="0 0 448 512" class="svg">
      <a href="/chat">
      <path d="M320 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM125.7 175.5c9.9-9.9 23.4-15.5 37.5-15.5c1.9 0 3.8 .1 5.6 .3L137.6 254c-9.3 28 1.7 58.8 26.8 74.5l86.2 53.9-25.4 88.8c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l28.7-100.4c5.9-20.6-2.6-42.6-20.7-53.9L238 299l30.9-82.4 5.1 12.3C289 264.7 323.9 288 362.7 288H384c17.7 0 32-14.3 32-32s-14.3-32-32-32H362.7c-12.9 0-24.6-7.8-29.5-19.7l-6.3-15c-14.6-35.1-44.1-61.9-80.5-73.1l-48.7-15c-11.1-3.4-22.7-5.2-34.4-5.2c-31 0-60.8 12.3-82.7 34.3L57.4 153.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l23.1-23.1zM91.2 352H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h69.6c19 0 36.2-11.2 43.9-28.5L157 361.6l-9.5-6c-17.5-10.9-30.5-26.8-37.9-44.9L91.2 352z"></path>
    </a>
      </svg>
      Live Feed
    </label>

  <script>
    function sendMessage() {
      var userInput = document.getElementById("user-input");
      var message = userInput.value;
      if (message.trim() !== "") {
        var chatBody = document.getElementById("chat-body");
        var newMessage = document.createElement("div");
        newMessage.className = "message outgoing";
        newMessage.innerHTML = `<img src="../static/image/myprofile.jpg" alt="Your Profile Picture" class="profile-pic">
                                <p>${message}</p>`;
        chatBody.appendChild(newMessage);
        userInput.value = ""; // Clear input field after sending message
        // Fetch random message and append it
        fetchRandomMessage();
      }
    }

    function fetchRandomMessage() {
      fetch('../data/messages.csv')
          .then(response => {
              if (!response.ok) {
                  throw new Error('Failed to fetch messages.csv');
              }
              return response.text();
          })
          .then(text => {
              console.log('CSV text:', text);
              const messages = text.split('\n').filter(message => message.trim() !== ''); // Filter out empty messages
              console.log('Messages:', messages);
              if (messages.length === 0) {
                  throw new Error('No messages found in messages.csv');
              }
              const randomIndex = Math.floor(Math.random() * messages.length);
              const randomMessage = messages[randomIndex];
              appendRandomMessage(randomMessage);
          })
          .catch(error => {
              console.error('Error fetching random message:', error);
              // Fallback response if fetching fails
              appendRandomMessage("Exploring the benefits of lightweight materials in car design.");
          });
    }

    function appendRandomMessage(message) {
      var chatBody = document.getElementById("chat-body");
      var newMessage = document.createElement("div");
      newMessage.className = "message incoming";
      newMessage.innerHTML = `<img src="../static/image/userprofile.jpg" alt="Profile Picture" class="profile-pic">
                              <p>${message}</p>`;
      chatBody.appendChild(newMessage);
    }
  </script>

</body>
</html>
